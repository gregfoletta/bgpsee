! FRR configuration for bgpsee integration tests
! FRR acts as AS 65001, bgpsee connects as AS 65000

frr version 8.4.1
frr defaults traditional
hostname frr-bgpsee-test
log syslog informational
service integrated-vtysh-config

! VRF definition (interface created by start-frr.sh)
vrf vrf-cust-a
 exit-vrf

! Static routes in VRF for VPNv4 testing
ip route 10.200.1.0/24 dummy0 vrf vrf-cust-a
ip route 10.200.2.0/24 dummy0 vrf vrf-cust-a
ip route 10.200.3.0/24 dummy0 vrf vrf-cust-a

! BGP configuration
router bgp 65001
 bgp router-id 172.28.0.2
 no bgp ebgp-requires-policy
 no bgp network import-check

 ! Neighbor configuration - bgpsee will connect from 172.28.0.1
 neighbor 172.28.0.1 remote-as 65000
 neighbor 172.28.0.1 passive
 neighbor 172.28.0.1 timers 10 30
 neighbor 172.28.0.1 description bgpsee-test-client

 ! IPv4 Unicast address family
 address-family ipv4 unicast
  neighbor 172.28.0.1 activate
  ! Test routes for IPv4
  network 192.168.1.0/24
  network 192.168.2.0/24
  network 10.100.0.0/16
  network 172.16.0.0/12
 exit-address-family

 ! IPv6 Unicast address family
 address-family ipv6 unicast
  neighbor 172.28.0.1 activate
  ! Test routes for IPv6
  network 2001:db8:1::/48
  network 2001:db8:2::/64
  network fd00::/8
 exit-address-family

 ! VPNv4 (MPLS VPN) address family
 address-family ipv4 vpn
  neighbor 172.28.0.1 activate
 exit-address-family

 ! L2VPN EVPN address family
 address-family l2vpn evpn
  neighbor 172.28.0.1 activate
  advertise-all-vni
 exit-address-family

exit

! BGP instance for VRF (VPNv4 routes)
router bgp 65001 vrf vrf-cust-a
 bgp router-id 172.28.0.2
 no bgp network import-check

 address-family ipv4 unicast
  redistribute connected
  redistribute static
  label vpn export auto
  rd vpn export 65001:100
  rt vpn both 65001:100
  export vpn
  import vpn
 exit-address-family

 address-family l2vpn evpn
  advertise ipv4 unicast
  rd 65001:100
  rt both 65001:100
 exit-address-family

exit

line vty
